# 分布式事务

## 2PC—两阶段提交

+ 阶段1：提交事务请求
+ 阶段2：执行事务提交

存在的问题：

事务管理器（TM）存在单点问题，会造成程序失效、数据不一致等问题，另外还有会阻塞资源、性能低等问题

## 3PC—三阶段提交

+ can commit ：先判断能否提交
+ pre commit ：预提交
+ do commit ：提交事务

相对于2PC，3PC主要解决单点故障问题，并减少阻塞

2/3PC的区别：

+ 3PC同时在协调者和参与者中都引入了超时机制，
+ 3PC增加了一个准备阶段，减少资源锁定（减少阻塞）

## LCN

Lock Confirm notify

+ Lock：锁定事务单元
+ Confirm：确认事务
+ Notify：通知事务

两阶段的一个实现，但是和2PC不完全一样

![](./res/LCN_yuanli.png)

比较重要的一步是需要保持数据库连接，如果数据库连接断了，或者等不到了，需要通过补偿机制来处理

### XA 协议

oracle提供的，两阶段实现

### TCC

+ try
+ confirm
+ cancle

### Seata

